# Most Common

- **Collapse effect spawn classifiers and log helpers in `client/network.js`.** Eight proposals call for replacing the repeated `is*Identifier`/`is*Spawn`/`log*` families with a shared matcher that gathers spawn candidates once and delegates to per-effect predicates. See [1350519539.md](./1350519539.md), [1518c38fe0.md](./1518c38fe0.md), [48e2192211.md](./48e2192211.md), [514533029e.md](./514533029e.md), [6b4a4acd04.md](./6b4a4acd04.md), [7b9d6f49de.md](./7b9d6f49de.md), [8db8b945e0.md](./8db8b945e0.md), and [951129319e.md](./951129319e.md).
- **Unify player and NPC path-following logic on the server.** Five notes highlight the duplicate state machines in `server/player_path.go` and `server/npc_path.go`, recommending a shared controller or helper to remove drift between `follow*Path`, `ensure*Path`, and related routines. Refer to [1518c38fe0.md](./1518c38fe0.md), [514533029e.md](./514533029e.md), [6b4a4acd04.md](./6b4a4acd04.md), [8db8b945e0.md](./8db8b945e0.md), and [951129319e.md](./951129319e.md).
- **Deduplicate inventory and equipment mutation wrappers.** Three surveys point out that `mutateActorInventory`, `mutateActorEquipment`, and the public `Mutate*` entrypoints all replay the same clone/mutate/patch steps, suggesting a single parameterised helper. See [1518c38fe0.md](./1518c38fe0.md), [6b4a4acd04.md](./6b4a4acd04.md), and [951129319e.md](./951129319e.md).
- **Share effect lifecycle normalization utilities.** Multiple notes flag the duplicated camelCase fallbacks and parsing helpers across `client/effect-lifecycle.js` and related modules, urging a shared utility for lifecycle batches and identifier cleanup. See [1350519539.md](./1350519539.md), [48e2192211.md](./48e2192211.md), and [6b4a4acd04.md](./6b4a4acd04.md).

# Highest Impact

- **Refactor player and NPC path controllers into a shared engine.** Consolidating `server/player_path.go` and `server/npc_path.go` into a configurable helper would eliminate two parallel state machines, making every stall/recalc tweak apply consistently and shrinking a core gameplay subsystem. Highlighted in [1518c38fe0.md](./1518c38fe0.md), [514533029e.md](./514533029e.md), [6b4a4acd04.md](./6b4a4acd04.md), [8db8b945e0.md](./8db8b945e0.md), and [951129319e.md](./951129319e.md).
- **Replace bespoke effect spawn classifiers with a data-driven matcher.** Turning the `client/network.js` `is*`/`log*` families into a shared matcher plus lookup table would remove hundreds of duplicated lines, make new VFX additions declarative, and harden us against transport schema drift. Summarised in [1350519539.md](./1350519539.md), [1518c38fe0.md](./1518c38fe0.md), [48e2192211.md](./48e2192211.md), [514533029e.md](./514533029e.md), [6b4a4acd04.md](./6b4a4acd04.md), [7b9d6f49de.md](./7b9d6f49de.md), [8db8b945e0.md](./8db8b945e0.md), and [951129319e.md](./951129319e.md).
- **Standardise world snapshot payloads and defaults at the source.** Creating shared structs for `joinResponse`, `stateMessage`, and `keyframeMessage`, and serving bootstrap defaults from the server, would collapse duplicated schema definitions across `server/messages.go`, `server/constants.go`, `server/world_config.go`, and the client bootstrap. See [7b9d6f49de.md](./7b9d6f49de.md), [48e2192211.md](./48e2192211.md), and [514533029e.md](./514533029e.md).
- **Generalise inventory/equipment mutation plumbing.** A single parameterised mutation helper in `server/world_mutators.go` would unify clone/mutate/patch flows for inventories and equipment, cutting boilerplate while guaranteeing consistent versioning and patch emission. Proposed in [1518c38fe0.md](./1518c38fe0.md), [6b4a4acd04.md](./6b4a4acd04.md), and [951129319e.md](./951129319e.md).

# Easiest Change

- **Treat `resyncPolicy` as a value instead of an optional pointer.** `newJournal` already instantiates the policy, so switching the struct and its methods in `server/resync_policy.go` to value receivers would let us delete the defensive `if p == nil` guards without wider fallout. Suggested in [1350519539.md](./1350519539.md).
- **Gate the hub's effect spam logging behind a debug flag.** Removing the unconditional `bytes.Contains` scans and snapshot dumps in `server/hub.go` is a low-effort cleanup that trims per-tick work and log noise. Captured in [7b9d6f49de.md](./7b9d6f49de.md).
- **Replace bespoke map copy helpers with Go's generic utilities.** Swapping `copyIntMap`/`copyBoolMap` for a single generic helper (or `maps.Clone`) clears duplicated code in `server/effects_manager.go` and `server/patches.go` with minimal risk. Noted in [514533029e.md](./514533029e.md).
- **Consolidate clamp helpers into a shared server utility.** Creating one `clamp`/`clampFloat` helper and reusing it across `server/obstacles.go`, `server/ground_items.go`, `server/stats/formulas.go`, and `server/effects_math.go` removes repeated min/max snippets in a straightforward refactor. Outlined in [48e2192211.md](./48e2192211.md).
