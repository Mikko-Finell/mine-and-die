# Simplification Survey

## Item 1: Consolidate path-following logic
- **File(s):** `server/player_path.go`, `server/npc_path.go`
- **Code:** `advancePlayerPaths`, `followPlayerPath`, `ensurePlayerPath`, `recalculatePlayerPath` mirror `advanceNPCPaths`, `followNPCPath`, `ensureNPCPath`, `recalculateNPCPath`.
- **Reason:** Both path controllers implement the same stall detection, recalc thresholds, and intent updates with only minor naming differences. Extracting a shared helper that operates on a common path state (player vs. NPC) would shrink the code, remove opportunities for the two copies to drift, and make future path-tuning changes apply consistently to every actor type.

## Item 2: Data-drive effect spawn diagnostics
- **File(s):** `client/network.js`
- **Code:** Families of helpers such as `isBloodSplatterIdentifier`, `isFireIdentifier`, `isAttackIdentifier`, `isMeleeSwingIdentifier`, plus the matching `is*Spawn`, `shouldLog*Spawn`, and `log*SpawnIfNeeded` chains.
- **Reason:** Each effect type repeats the same candidate collection, message-type filtering, and logging pattern with only the identifier string and log label changing. Replacing these copies with a small table of `{ idMatchers, logLabel }` definitions would collapse the duplication, make it trivial to add/remove tracked effects, and reduce the risk of keeping one pathway in sync when the message format shifts.

## Item 3: Unify entity view normalization
- **File(s):** `client/patches.js`
- **Code:** `createPlayerView` vs. `clonePlayerView`, `createNPCView` vs. `cloneNPCView`, and the equivalent ground-item helpers.
- **Reason:** The "create" and "clone" functions duplicate the same normalization and fallback logic, differing only by which source object they read from. Introducing shared normalizers (e.g., `normalizePlayerView(source)`) would prevent drift between the constructor and cloning paths, simplify tests, and make it easier to adjust the client-side schema in one place.

## Item 4: Share status-effect hook plumbing
- **File(s):** `server/effects_manager.go`
- **Code:** The `statusBurningVisualHookID` and `statusBurningDamageHookID` handlers inside `defaultEffectHookRegistry`.
- **Reason:** Both hook implementations repeat the same target resolution (`FollowActorID` vs. `DeliveryState.AttachedActorID`), actor lookups, and cached effect retrieval before applying their specific behavior. Extracting a reusable helper to fetch the actor/effect pair once would cut down on nil-guard boilerplate, make it easier to extend to other status effects, and reduce the chance of fixing a bug in one hook but forgetting the other copy.
